(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))a(r);new MutationObserver(r=>{for(const n of r)if(n.type==="childList")for(const i of n.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&a(i)}).observe(document,{childList:!0,subtree:!0});function t(r){const n={};return r.integrity&&(n.integrity=r.integrity),r.referrerPolicy&&(n.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?n.credentials="include":r.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function a(r){if(r.ep)return;r.ep=!0;const n=t(r);fetch(r.href,n)}})();const ae={night:"Good night, ",morning:"Good morning, ",afternoon:"Good afternoon, ",evening:"Good evening, ","[placeholder]weather-city-input":"Enter your city name","weather-error":"Error","weather-wind-text":"Wind speed: ","weather-speedUnit":"m/s",humidity:"Humidity: ","hello-name":"Hello, ","[placeholder]customerName":"Enter your name","todo-input-label":"Type your task &#8628;","[placeholder]todo-input":"What would you like to do today?","todo-hide-completed":"Hide completed tasks","settings-change-lang":"Change language","settings-change-lang-ru":"RU","settings-change-lang-en":"EN","settings-remove-data":"User data","settings-edit-data-btn":"Edit","settings-remove-data-btn":"Remove","settings-background":"Background source ","settings-background-api":"Unsplash","settings-background-github":"GitHub","settings-quotes":"Quotes source","settings-quotes-api":"API","settings-quotes-github":"Static","settings-name":"Your name","settings-city":"You city (for weather widget)","hide-player-on":"Hide player","hide-player-off":"Show player","hide-weather-on":"Hide weather","hide-weather-off":"Show weather","hide-clocks-on":"Hide time","hide-clocks-off":"Show time","hide-date-on":"Hide date","hide-date-off":"Show date","hide-greetings-on":"Hide greetings","hide-greetings-off":"Show greetings","hide-todo-on":"Hide todo","hide-todo-off":"Show todo","hide-quotes-on":"Hide quotes","hide-quotes-off":"Show quotes","hide-layouts-on":"Show layouts","hide-layouts-off":"Hide layouts","my-github":"My GitHub",locales:"en-Gb"},re={night:"Доброй ночи, ",morning:"Доброе утро, ",afternoon:"Добрый день, ",evening:"Добрый вечер, ","[placeholder]weather-city-input":"Введите название города","weather-error":"Ошибка!","weather-wind-text":"Скорость ветра: ","weather-speedUnit":"м/с",humidity:"Влажность: ","hello-name":"Привет, ","[placeholder]customerName":"Введите Ваше имя","todo-input-label":"Добавьте задачу &#8628;","[placeholder]todo-input":"Чем займемся сегодня?","todo-hide-completed":"Спрятать выполненные задачи","settings-change-lang":"Сменить язык","settings-change-lang-ru":"РУС","settings-change-lang-en":"АНГЛ","settings-remove-data":"Данные пользователя","settings-edit-data-btn":"Изменить","settings-remove-data-btn":"Удалить","settings-background":"Источник обоев","settings-background-api":"Unsplash","settings-background-github":"GitHub","settings-quotes":"Источник цитат","settings-quotes-api":"API","settings-quotes-github":"Статический","settings-name":"Ваше имя","settings-city":"Ваш город (для виджета погоды","hide-player-on":"Спрятать плеер","hide-player-off":"Показать плеер","hide-weather-on":"Спрятать погоду","hide-weather-off":"Показать погоду","hide-clocks-on":"Спрятать часы","hide-clocks-off":"Показать часы","hide-date-on":"Спрятать дату","hide-date-off":"Показать дату","hide-greetings-on":"Спрятать приветствие","hide-greetings-off":"Показать приветствие","hide-todo-on":"Спрятать задачи","hide-todo-off":"Показать задачи","hide-quotes-on":"Спрятать цитаты","hide-quotes-off":"Показать цитаты","hide-layouts-on":"Включить подложки под блоки","hide-layouts-off":"Отключить подложки под блоки","my-github":"Мой GitHub",locales:"ru-Ru"},w={};w.en=ae;w.ru=re;const ne=[{id:0,author:"The Moth & The Flame",title:"Simple",src:""},{id:1,author:"Coldplay",title:"Paradise",src:""},{id:2,author:"Lord Huron",title:"The Night We Met",src:""},{id:3,author:"Arcane Roots",title:"Half the World",src:""}],ie={play:"src/assets/svg/sprite.svg#play",pause:"src/assets/svg/sprite.svg#pause",volume:"src/assets/svg/sprite.svg#volume",mute:"src/assets/svg/sprite.svg#mute"},oe=[{quote:"The only sin is ignorance",source:"Christopher Marlowe"},{quote:"A man is his own easiest dupe, for what he wishes to be true he generally believes to be true",source:"Demosthenes"},{quote:"A lie can travel halfway around the world while the truth is putting on its shoes",source:"Mark Twain"}],l={setItemToLocalStorage(s,e){return localStorage.setItem(s,e),e},getItemFromLocalStorage(s){return localStorage.getItem(s)},deleteItemFromLocalStorage(s){return localStorage.removeItem(s),!0},clearLocalStorage(){return localStorage.clear(),!0},setObjectFieldsToLocalStorage(s,e){const t=`${e}-${s.id}`;Object.keys(s).forEach(a=>{!localStorage.getItem(`${t}-${a}`)&&a!=="id"&&localStorage.setItem(`${t}-${a}`,`${s[a]}`)})},deleteObjectFieldsFromLocalStorage(s,e){const t=`${e}-${s.id}`;Object.keys(s).forEach(a=>{a!=="id"&&localStorage.getItem(`${t}-${a}`)&&localStorage.removeItem(`${t}-${a}`)})}},O={HTMLElements:{background:{selector:".body",element:null},prevBG:{selector:".prev-item",element:null},mainBG:{selector:".main-item",element:null},nextBG:{selector:".next-item",element:null},carousel:{selector:".carousel",element:null},prev:{selector:".slide-prev",element:null},next:{selector:".slide-next",element:null},playerBlock:{selector:".player",element:null},audioTag:{selector:"#player__audio",element:null},playPrev:{selector:"div[data-button-name='play-prev']",element:null},playNext:{selector:"div[data-button-name='play-next']",element:null},play:{selector:"div[data-button-name='play']",element:null},pause:{selector:"div[data-button-name='pause']",element:null},volumeIcon:{selector:".player-controls__volume .use-icon",element:null},volumeRange:{selector:"[data-button-name='range']",element:null},playlist:{selector:".playlist",element:null},animationBulbs:{selector:".song__sphere",element:null,isArray:!0},weatherBlock:{selector:".weather",element:null},cityNameBlock:{selector:".city-name-block",element:null},cityNameDiv:{selector:".city-name__div",element:null},cityInput:{selector:".city-name__input",element:null},errorBlock:{selector:".weather__error-block",element:null},iconPath:{selector:".weather-icon",element:null},temperatureBlock:{selector:".temperature",element:null},temperature:{selector:".temperature__number",element:null},description:{selector:".weather-description",element:null},windBlock:{selector:".wind",element:null},windSpeed:{selector:".wind__speedNumber",element:null},humidityBlock:{selector:".humidity",element:null},humidity:{selector:".humidity__number",element:null},time:{selector:".time",element:null},date:{selector:".date",element:null},greetsBlock:{selector:".greeting-container",element:null},greeting:{selector:".greeting",element:null},nameBox:{selector:".name__box",element:null},nameDiv:{selector:".name__div",element:null},nameInput:{selector:".name__input",element:null},ToDoInputWrapper:{selector:".to-do__header",element:null},ToDoInput:{selector:".to-do__input",element:null},tasksList:{selector:".to-do__task-list",element:null},quote:{selector:".quote__quote",element:null},quoteAuthor:{selector:".quote__author",element:null},settingsBlock:{selector:".footer__settings",element:null}},translation:w,blocks:["Player","Weather","Clocks","Date","Greets","ToDo","Quotes","Settings","Background"],player:{tracksMap:ne,src:["/sounds/",".mp3"],volume:+l.getItemFromLocalStorage("volume")||30,isMuted:+l.getItemFromLocalStorage("isMuted")||!1,currentTrackID:+l.getItemFromLocalStorage("currentTrackID")||1,pathToSVGIcon:"src/assets/svg/sprite.svg#",svgPathEndpoints:ie,buttonsToToggle:{play:"pause",pause:"play",volume:"mute",mute:"volume"},SVGClassButtons:["play","pause","play-prev","play-next","volume"]},weather:{responseSchema:{iconPath:["weather","0","icon"],description:["weather","0","description"],temperature:["main","temp"],humidity:["main","humidity"],windSpeed:["wind","speed"]},APIKey:"1e86aeecc6661092d35f019637c03153",urlToIcon:"https://openweathermap.org/img/wn/",blocksToHide:["iconPath","temperatureBlock","description","windBlock","humidityBlock"]},clocks:{isAPISource:l.getItemFromLocalStorage("isSourceAPI_bg"),timeOfADayBorders:{morning:{start:5,end:11},afternoon:{start:12,end:16},evening:{start:17,end:19},night1:{start:20,end:23},night2:{start:0,end:4}},dateOptions:{weekday:"long",year:"numeric",month:"long",day:"numeric"}},quotes:{url:"https://type.fit/api/quotes",APIKey:"",quotesArray:oe,source:l.getItemFromLocalStorage("isSourceAPI_q")||"project"},toDo:{tasksArray:[{taskValue:"Something",done:!1,id:0},{taskValue:"To",done:!1,id:1},{taskValue:"Do",done:!1,id:2}]}};class _{constructor(e,t,a,r){this.lang=e,this.name=t,this.city=r,this.HTMLElements=a}setNewSVGPath(e,t){return e.setAttribute("xlink:href",t)}changeElementSvg(e,t,a,r){return this.setNewSVGPath(e,t),e.classList.remove(a),e.classList.add(r),e}searchHTMLElements(){for(const e in this.HTMLElements)this.HTMLElements[e].isArray?this.HTMLElements[e].element=document.querySelectorAll(this.HTMLElements[e].selector):this.HTMLElements[e].element=document.querySelector(this.HTMLElements[e].selector)}getRandomNumber(e){return Math.floor(Math.random()*e+1)}createDatasetName(e){const t=e.split("-").slice(1);let a=t[0];if(t.length>1)for(let r=1;r<t.length;r++){let n=t[r].split("");n[0]=n[0].toUpperCase(),n=n.join(""),a+=n}return a}async getData(e){const t=await fetch(`${e}`);return{isOk:t.ok,json:await t.json()}}async getDataNoCors(e){const t=await fetch(`${e}`);if(t.ok)return t.json();throw new Error(`Ошибка, данные не получены   ${t.status}`)}createElement(e,t,a,r){const n=document.createElement(e);return t&&(Array.isArray(t)?n.classList.add(...t):n.classList.add(t)),a&&a.append(n),r&&r.forEach(i=>{const o=Object.keys(i)[0];if(o.split("-").includes("data")){const c=this.createDatasetName(o);n.dataset[c]=i[o]}else n.setAttribute(o,i[o])}),n}}const S=""+new URL("sprite-abf30701.svg",import.meta.url).href;class le extends _{constructor(e,t,a,r,n){super(e,t,r,a),this._volumeLevel=n.volume,this._isMuted=n.isMuted,this._prevPlayedTrackID=null,this._nextPlayedTrackID=null,this._currentTrackID=n.currentTrackID,this.pathToSVG=n.pathToSVGIcon,this.buttonsToToggle=n.buttonsToToggle,this._numberOfTracks=null,this._srcPath=n.src,this.tracksMap=n.tracksMap,this._refreshProgressBarProcessID=null,this._isPlaying=!1,this._songButtons=[],this._isFirstClick=!0,this._savedPlayedTrackID=null}playerClicksHandler(e,t){const a=e.target.dataset;a.buttonName==="playManagement"?this.setPlayPause(this._currentTrackID,!this._isPlaying):a.buttonName==="play-prev"?(this.refreshTrackData(this.findPrevTrackID(this._currentTrackID)),this.setSongTitleToProgressBar(this._currentTrackID),this.setSrcToAudioTag(this._currentTrackID),this._isPlaying?this.setPlayPause(this.getCurrentTrackID(),this._isPlaying):this.HTMLElements.audioTag.element.pause()):a.buttonName==="play-next"?(this.refreshTrackData(this.findNextTrackID(this._currentTrackID)),this.setSongTitleToProgressBar(this._currentTrackID),this.setSrcToAudioTag(this._currentTrackID),this._isPlaying?this.setPlayPause(this.getCurrentTrackID(),this._isPlaying):this.HTMLElements.audioTag.element.pause()):a.buttonName==="volume"?(this.setMuted(!this._isMuted),this._isMuted?(this.setVolumeToAudioTag(0),this.changeElementSvg(this.HTMLElements.volumeIcon.element,this.pathToSVG+"mute","unmute","mute")):(this.setVolumeToAudioTag(this._volumeLevel),this.changeElementSvg(this.HTMLElements.volumeIcon.element,this.pathToSVG+"sound-speaker","mute","unmute"))):e.target.closest(".song__content")?(this.setCurrentTrackID=+a.songId,this.setPreviousTrackID=this.findPrevTrackID(this.getCurrentTrackID()),this.setNextTrackID=this.findNextTrackID(this.getCurrentTrackID()),console.log("this._isFirstClick "+this._isFirstClick),this._isFirstClick&&(this._isFirstClick=!this._isFirstClick,this._isPlaying=!0),this._isPlaying&&this.getCurrentTrackID()!==+a.songId&&(this._isPlaying=!1),this.setPlayPause(this.getCurrentTrackID(),this._isPlaying)):console.log("unknown dataset")}shouldPlay(e){if(this._savedPlayedTrackID!==this._currentTrackID)if(this._isPlaying)switch(e){case"playManagement":{console.log("поставить на паузу");break}case"play-prev":{console.log("пусть играет дальше");break}case"play-next":{console.log("пусть играет дальше");break}case"song__content":{console.log("пусть играет дальше");break}}else switch(e){case"playManagement":{console.log("запустить, чтобы играло");break}case"play-prev":{console.log("пусть остается в паузе");break}case"play-next":{console.log("пусть остается в паузе");break}case"song__content":{console.log("запустить, чтобы играло");break}}else if(this._isPlaying)switch(e){case"playManagement":{console.log("поставить на паузу");break}case"song__content":{console.log("поставить на паузу");break}}else switch(e){case"playManagement":{console.log("запустить, чтобы играло");break}case"song__content":{console.log("запустить, чтобы играло");break}}}setUp(){this.setNumberOfTracks(this.tracksMap),this.refreshTrackData(this._currentTrackID)}synchronizeVolumeLevelDisplay(){this.HTMLElements.volumeRange.element.value=this._volumeLevel}toggleMuteIcon(){+this._volumeLevel!=0?this.changeElementSvg(this.HTMLElements.volumeIcon.element,this.pathToSVG+"sound-speaker","mute","unmute"):this.changeElementSvg(this.HTMLElements.volumeIcon.element,this.pathToSVG+"mute","unmute","mute")}startPlayer(){this.setUp(),this.createPlayer(),this.searchHTMLElements(),this.setSongTitleToProgressBar(this._currentTrackID),this.synchronizeVolumeLevelDisplay(),this.toggleMuteIcon(),this.checkAudioTag(),this.HTMLElements.audioTag.element.addEventListener("ended",e=>{this.endTrackListener()}),this.setSrcToAudioTag(this.getCurrentTrackID()),this.setVolumeToAudioTag(this._volumeLevel),this.HTMLElements.audioTag.element.pause()}changeHandler(e,t){[...e.target.classList].includes("volume-bar__range")&&(this._volumeLevel=+e.target.value,this._volumeLevel===0?(this.setMuted(!0),this.changeElementSvg(this.HTMLElements.volumeIcon.element,this.pathToSVG+"mute","unmute","mute")):(this.setMuted(!1),this.changeElementSvg(this.HTMLElements.volumeIcon.element,this.pathToSVG+"sound-speaker","mute","unmute")),this.setVolumeToAudioTag(this._volumeLevel))}endTrackListener(){this.setCurrentTrackID=this.findNextTrackID(this._currentTrackID),this._isPlaying=!0,this.setPlayPause(this.getCurrentTrackID(),this._isPlaying)}setVolumeToAudioTag(e){this.HTMLElements.audioTag.element.volume=e/100}setMuted(e){this._isMuted=e,l.setItemToLocalStorage("isMuted",e)}findPrevTrackID(e){let t;const a=e-1;return a<0?t=this._numberOfTracks-1:a>this._numberOfTracks-1?t=0:t=a,+t}set setPreviousTrackID(e){return this._prevPlayedTrackID=+e,this._prevPlayedTrackID}findNextTrackID(e){let t;const a=e+1;return a>this._numberOfTracks-1?t=0:a<0?t=this._numberOfTracks-1:t=a,+t}set setNextTrackID(e){return this._nextPlayedTrackID=+e,this._nextPlayedTrackID}set setCurrentTrackID(e){if(e>=0&&e<this._numberOfTracks)this._currentTrackID=e,l.setItemToLocalStorage("currentTrackID",this._currentTrackID);else throw new Error(`Ошибка! ID текущего трека не может быть более ${this._numberOfTracks-1} и менее 0`)}setNumberOfTracks(e){return this._numberOfTracks=e.length,this._numberOfTracks}refreshTrackData(e){this.setCurrentTrackID=e,this.setNextTrackID=this.findNextTrackID(e),this.setPreviousTrackID=this.findPrevTrackID(e),l.setItemToLocalStorage("currentTrackID",e)}getPrevPlayedTrackID(){return this._prevPlayedTrackID}getNextPlayedTrackID(){return this._nextPlayedTrackID}getCurrentTrackID(){return this._currentTrackID}getNumberOfTracks(){return this._numberOfTracks}checkAudioTag(){(!this.HTMLElements.audioTag||!this.HTMLElements.audioTag.element)&&(this.HTMLElements.audioTag={element:document.querySelector(".player__audio"),selector:".player__audio"})}setSrcToAudioTag(e){this.HTMLElements.audioTag.element.src=this._srcPath[0]+e+this._srcPath[1]}createPlayer(){const e=this.HTMLElements.playerBlock.element=document.querySelector(".player");e.innerHTML="",e.insertAdjacentHTML("afterbegin",`
              <audio class="player__audio" id="player__audio" preload="auto"></audio>
              <div class="player__header">
                <div class="player-controls">
                  <div class="player-controls__playback">
                    <div class="player-icon svg-parent" data-button-name="play-prev">
                      <svg class="svg-icon" data-button-name="play-prev">
                        <use class="use-icon" data-button-name="play-prev"
                             xlink:href="${S}#play-prev"></use>
                      </svg>
                    </div>
                    <div class="player-icon svg-parent" data-button-name="playManagement">
                      <svg class="svg-icon" data-button-name="playManagement">
                        <use class="use-icon" data-button-name="playManagement" xlink:href="${S}#play"></use>
                      </svg>
                    </div>
                    <div class="player-icon svg-parent" data-button-name="play-next">
                      <svg class="svg-icon" data-button-name="play-next">
                        <use class="use-icon" data-button-name="play-next"
                             xlink:href="${S}#play-next"></use>
                      </svg>
                    </div>
                  </div>
                  <div class="player-controls__volume svg-parent" data-button-name="volume">
                    <svg class="svg-icon" data-button-name="volume">
                      <use class="use-icon" data-button-name="volume" xlink:href="${S}#sound-speaker"></use>
                    </svg>
                    <div class="volume-bar__wrapper">
                      <input class="volume-bar__range" type="range" min="0" max="100" step="1" value="${this._volumeLevel}" data-button-name="range"></div>
                  </div>
                </div>
                
                <div class="player__progress progress visible">
                  <div class="progress__title">Song TITLE</div>
                  <div class="progress__bar">
                    <div class="progress__start"></div>
                    <div class="progress__end">
                    </div>
                  </div>
                </div>
              </div>
      
              <!--<div class="playlist">
                <ul class="playlist__wrapper">
                </ul>
              </div>-->
            `);const t=this.createElement("div","playlist",e),a=this.createElement("ul","playlist__wrapper",t);for(let r=0;r<this._numberOfTracks;r++)a.insertAdjacentHTML("beforeend",`
            <li class="song">
              <div class="song__content" data-song-id="${r}" data-button-name="song-content">
                <div class="song__sphere" data-song-id="${r}"></div>
                <div class="song__title" data-song-id="${r}" data-button-name="song-content">${this.tracksMap[r].author} - ${this.tracksMap[r].title}</div>
                <svg class="svg-icon" data-song-id="${r}" data-button-name="song-content">
                  <use class="use-icon" data-song-id="${r}" data-button-name="song-content"
                       xlink:href="${S}#play"></use>
                </svg>
              </div>
            </li>
            `)}playAndStopAnimationListener(){this.HTMLElements.animationBulbs.element.forEach(e=>{e.classList.remove("isPlaying"),!this.HTMLElements.audioTag.element.paused&&+e.dataset.songId===this.getCurrentTrackID()&&e.classList.add("isPlaying")})}playerToggleButtonListener(e){this._songButtons=document.querySelectorAll(".song__content .use-icon"),this._songButtons.forEach(c=>{[...c.classList].includes("pause")&&this.changeElementSvg(c,this.pathToSVG+"play",this.buttonsToToggle.play,"play")});let t=[];const a=this.HTMLElements.audioTag.element.paused?"play":"pause",r=`data-song-id="${e}"`,n='data-button-name="playManagement"',i=document.querySelector(`.use-icon[${r}]`);t.push(i);const o=document.querySelector(`.use-icon[${n}]`);t.push(o),t.forEach(c=>this.changeElementSvg(c,this.pathToSVG+a,this.buttonsToToggle[a],a))}updateProgressBar(e){const t=document.querySelector(".progress__bar");this._refreshProgressBarProcessID=setTimeout(()=>{const a=this.HTMLElements.audioTag.element.currentTime;if(e)if(a<=e){const r=Math.round(a*100/e),n=100-r;t.style["grid-template-columns"]=`${r}% ${n}%`,this.updateProgressBar(e),a===e&&(this.playerToggleButtonListener(this.getCurrentTrackID()),clearTimeout(this._refreshProgressBarProcessID))}else this.playerToggleButtonListener(this.getCurrentTrackID()),clearTimeout(this._refreshProgressBarProcessID)},1e3)}setSongTitleToProgressBar(e){document.querySelector(".progress__title").innerHTML=document.querySelector(`.song__title[data-song-id="${e}"]`).innerHTML}setPlayPause(e,t){if(this.setSrcToAudioTag(e),this._refreshProgressBarProcessID&&clearTimeout(this._refreshProgressBarProcessID),this.setSongTitleToProgressBar(e),t){this._isPlaying=!0,this.HTMLElements.audioTag.element.play(),this.playerToggleButtonListener(e),this._isProgressBarShown=!0,this.showProgressBar();let a;this.updateProgressBar(0),this.HTMLElements.audioTag.element.addEventListener("loadedmetadata",()=>{this._refreshProgressBarProcessID&&clearTimeout(this._refreshProgressBarProcessID),a=this.HTMLElements.audioTag.element.duration,this.updateProgressBar(a)})}else this._isPlaying=!1,this.HTMLElements.audioTag.element.pause(),this.playerToggleButtonListener(e),this.updateProgressBar();this.playAndStopAnimationListener(),this._currentTrackID!==e&&(this._currentTrackID=e,this.setLocalStorageProperty("currentTrackID",this._currentTrackID),this.setLocalStorageProperty("nextTrackID",this.setNextTrackID=this._currentTrackID+1),this.setLocalStorageProperty("prevTrackID",this.setPreviousTrackID=this._currentTrackID-1))}showProgressBar(){document.querySelector(".progress").classList.add("visible")}setLocalStorageProperty(e,t){localStorage.setItem(e,t)}setVolumeChanges(e){this.checkAudioTag(),this.HTMLElements.audioTag.element.volume=e,this.setLocalStorageProperty("volume",e)}}/*!
 * content-type
 * Copyright(c) 2015 Douglas Christopher Wilson
 * MIT Licensed
 */var $=/; *([!#$%&'*+.^_`|~0-9A-Za-z-]+) *= *("(?:[\u000b\u0020\u0021\u0023-\u005b\u005d-\u007e\u0080-\u00ff]|\\[\u000b\u0020-\u00ff])*"|[!#$%&'*+.^_`|~0-9A-Za-z-]+) */g,ce=/\\([\u000b\u0020-\u00ff])/g,he=/^[!#$%&'*+.^_`|~0-9A-Za-z-]+\/[!#$%&'*+.^_`|~0-9A-Za-z-]+$/,ue=de;function de(s){if(!s)throw new TypeError("argument string is required");var e=typeof s=="object"?me(s):s;if(typeof e!="string")throw new TypeError("argument string is required to be a string");var t=e.indexOf(";"),a=t!==-1?e.slice(0,t).trim():e.trim();if(!he.test(a))throw new TypeError("invalid media type");var r=new ge(a.toLowerCase());if(t!==-1){var n,i,o;for($.lastIndex=t;i=$.exec(e);){if(i.index!==t)throw new TypeError("invalid parameter format");t+=i[0].length,n=i[1].toLowerCase(),o=i[2],o.charCodeAt(0)===34&&(o=o.slice(1,-1),o.indexOf("\\")!==-1&&(o=o.replace(ce,"$1"))),r.parameters[n]=o}if(t!==e.length)throw new TypeError("invalid parameter format")}return r}function me(s){var e;if(typeof s.getHeader=="function"?e=s.getHeader("content-type"):typeof s.headers=="object"&&(e=s.headers&&s.headers["content-type"]),typeof e!="string")throw new TypeError("content-type header is missing from object");return e}function ge(s){this.parameters=Object.create(null),this.type=s}function u(){return u=Object.assign||function(s){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(s[a]=t[a])}return s},u.apply(this,arguments)}function g(s,e){if(s==null)return{};var t={},a=Object.keys(s),r,n;for(n=0;n<a.length;n++)r=a[n],!(e.indexOf(r)>=0)&&(t[r]=s[r]);return t}var pe=L(function(s){return typeof s=="string"?s:null}),f=function(e){return e!=null};function L(s){return function(e){return f(s(e))}}var ye=function(e){return e.length>0},y=function(e){return Object.keys(e).reduce(function(t,a){var r,n=e[a];return u({},t,f(n)?(r={},r[a]=n,r):{})},{})};function M(){for(var s=arguments.length,e=new Array(s),t=0;t<s;t++)e[t]=arguments[t];var a=e.length-1;return function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];for(var o=e[0].apply(this,n),c=1;c<=a;c++)o=e[c].call(this,o);return o}}var fe=L(function(s){return f(s)&&typeof s=="object"&&!Array.isArray(s)?s:null}),Te=L(function(s){return Array.isArray(s)&&s.every(pe)&&ye(s)?s:null}),ke=L(function(s){return fe(s)&&"errors"in s&&Te(s.errors)?{errors:s.errors}:null}),ve=function(e){return ke(e)?{errors:e.errors,source:"api"}:{errors:["Responded with a status code outside the 2xx range, and the response body is not recognisable."],source:"decoding"}},P=function(e){this.message=e},_e="content-type",be="application/json",Se=function(e){var t=e.headers.get(_e);return f(t)&&ue(t).type===be},V=function(e){if(Se(e))return e.json().catch(function(t){throw new P("unable to parse JSON response.")});throw new P("expected JSON response from server.")},Ie=function(e){return function(t){return(t.ok?e({response:t}).then(function(a){return{type:"success",status:t.status,response:a,originalResponse:t}}):V(t).then(function(a){return u({type:"error",status:t.status},ve(a),{originalResponse:t})})).catch(function(a){if(a instanceof P)return{type:"error",source:"decoding",status:t.status,originalResponse:t,errors:[a.message]};throw a})}},m=function(){return function(e){var t=e.response;return V(t)}},Pe=function(e){return function(t){Object.keys(e).forEach(function(a){return t.searchParams.set(a,e[a].toString())})}},De=function(e){return function(t){t.pathname==="/"?t.pathname=e:t.pathname+=e}},Ee=function(e){var t=e.pathname,a=e.query;return function(r){var n=new URL(r);return De(t)(n),Pe(a)(n),n.toString()}},we=function(e){var t={};return e.forEach(function(a,r){t[r]=a}),t},Le=function(e){var t=new URL(e),a=t.pathname,r=t.searchParams,n=we(r);return{query:n,pathname:a==="/"?void 0:a}},d=function(e){return function(t,a){a===void 0&&(a={});var r=e(t),n=r.headers,i=r.query,o=g(r,["headers","query"]);return u({},o,a,{query:i,headers:u({},n,a.headers)})}},h=function(e){return e},He=function(e){var t=e.accessKey,a=e.apiVersion,r=a===void 0?"v1":a,n=e.apiUrl,i=n===void 0?"https://api.unsplash.com":n,o=e.headers,c=e.fetch,k=g(e,["accessKey","apiVersion","apiUrl","headers","fetch"]);return function(b){var W=b.handleResponse,Q=b.handleRequest;return M(Q,function(v){var K=v.pathname,z=v.query,B=v.method,Y=B===void 0?"GET":B,J=v.headers,X=v.body,Z=v.signal,ee=Ee({pathname:K,query:z})(i),te=u({method:Y,headers:u({},o,J,{"Accept-Version":r},f(t)?{Authorization:"Client-ID "+t}:{}),body:X,signal:Z},k),se=c??fetch;return se(ee,te).then(Ie(W))})}},q="x-total",Ae=function(e){var t=e.headers.get(q);if(f(t)){var a=parseInt(t);if(Number.isInteger(a))return a;throw new P("expected "+q+" header to be valid integer.")}else throw new P("expected "+q+" header to exist.")},T=function(){return function(e){var t=e.response;return m()({response:t}).then(function(a){return{results:a,total:Ae(t)}})}},F=function(e){return f(e)?{collections:e.join()}:{}},qe=function(e){return f(e)?{topics:e.join()}:{}},p=function(e){var t=e.page,a=e.perPage,r=e.orderBy;return y({per_page:a,order_by:r,page:t})},H="/collections",Me=function(){var s=function(t){var a=t.collectionId;return H+"/"+a+"/photos"};return h({getPathname:s,handleRequest:d(function(e){var t=e.collectionId,a=e.orientation,r=g(e,["collectionId","orientation"]);return{pathname:s({collectionId:t}),query:y(u({},p(r),{orientation:a}))}}),handleResponse:T()})}(),Ce=function(){var s=function(t){var a=t.collectionId;return H+"/"+a};return h({getPathname:s,handleRequest:d(function(e){var t=e.collectionId;return{pathname:s({collectionId:t}),query:{}}}),handleResponse:m()})}(),Be=function(){var s=function(){return H};return h({getPathname:s,handleRequest:d(function(e){return e===void 0&&(e={}),{pathname:s(),query:p(e)}}),handleResponse:T()})}(),Oe=function(){var s=function(t){var a=t.collectionId;return H+"/"+a+"/related"};return h({getPathname:s,handleRequest:d(function(e){var t=e.collectionId;return{pathname:s({collectionId:t}),query:{}}}),handleResponse:m()})}(),D="/photos",$e=function(){var s=function(){return D};return h({getPathname:function(t){return s()},handleRequest:d(function(e){return e===void 0&&(e={}),{pathname:D,query:y(p(e))}}),handleResponse:T()})}(),xe=function(){var s=function(t){var a=t.photoId;return D+"/"+a};return h({getPathname:s,handleRequest:d(function(e){var t=e.photoId;return{pathname:s({photoId:t}),query:{}}}),handleResponse:m()})}(),Re=function(){var s=function(t){var a=t.photoId;return D+"/"+a+"/statistics"};return h({getPathname:s,handleRequest:d(function(e){var t=e.photoId;return{pathname:s({photoId:t}),query:{}}}),handleResponse:m()})}(),Ne=function(){var s=function(){return D+"/random"};return h({getPathname:s,handleRequest:d(function(e){var t=e===void 0?{}:e,a=t.collectionIds,r=t.contentFilter,n=t.topicIds,i=g(t,["collectionIds","contentFilter","topicIds"]);return{pathname:s(),query:y(u({},i,{content_filter:r},F(a),qe(n))),headers:{"cache-control":"no-cache"}}}),handleResponse:m()})}(),Ge={handleRequest:d(function(s){var e=s.downloadLocation,t=Le(e),a=t.pathname,r=t.query;if(!f(a))throw new Error("Could not parse pathname from url.");return{pathname:a,query:y(r)}}),handleResponse:m()},C="/search",Ve=function(){var s=function(){return C+"/photos"};return h({getPathname:function(t){return s()},handleRequest:d(function(e){var t=e.query,a=e.page,r=e.perPage,n=e.orderBy,i=e.collectionIds,o=e.lang,c=e.contentFilter,k=g(e,["query","page","perPage","orderBy","collectionIds","lang","contentFilter"]);return{pathname:s(),query:y(u({query:t,content_filter:c,lang:o,order_by:n},p({page:a,perPage:r}),F(i),k))}}),handleResponse:m()})}(),Fe=function(){var s=function(){return C+"/collections"};return h({getPathname:function(t){return s()},handleRequest:d(function(e){var t=e.query,a=g(e,["query"]);return{pathname:s(),query:u({query:t},p(a))}}),handleResponse:m()})}(),Ue=function(){var s=function(){return C+"/users"};return h({getPathname:function(t){return s()},handleRequest:d(function(e){var t=e.query,a=g(e,["query"]);return{pathname:s(),query:u({query:t},p(a))}}),handleResponse:m()})}(),A="/users",je=function(){var s=function(t){var a=t.username;return A+"/"+a};return h({getPathname:s,handleRequest:d(function(e){var t=e.username;return{pathname:s({username:t}),query:{}}}),handleResponse:m()})}(),We=function(){var s=function(t){var a=t.username;return A+"/"+a+"/photos"};return h({getPathname:s,handleRequest:d(function(e){var t=e.username,a=e.stats,r=e.orientation,n=g(e,["username","stats","orientation"]);return{pathname:s({username:t}),query:y(u({},p(n),{orientation:r,stats:a}))}}),handleResponse:T()})}(),Qe=function(){var s=function(t){var a=t.username;return A+"/"+a+"/likes"};return h({getPathname:s,handleRequest:d(function(e){var t=e.username,a=e.orientation,r=g(e,["username","orientation"]);return{pathname:s({username:t}),query:y(u({},p(r),{orientation:a}))}}),handleResponse:T()})}(),Ke=function(){var s=function(t){var a=t.username;return A+"/"+a+"/collections"};return h({getPathname:s,handleRequest:d(function(e){var t=e.username,a=g(e,["username"]);return{pathname:s({username:t}),query:p(a)}}),handleResponse:T()})}(),U="/topics",E=function(e){var t=e.topicIdOrSlug;return U+"/"+t},ze=h({getPathname:E,handleRequest:function(e){var t=e.page,a=e.perPage,r=e.orderBy,n=e.topicIdsOrSlugs;return{pathname:U,query:y(u({},p({page:t,perPage:a}),{ids:n==null?void 0:n.join(","),order_by:r}))}},handleResponse:T()}),Ye=h({getPathname:E,handleRequest:function(e){var t=e.topicIdOrSlug;return{pathname:E({topicIdOrSlug:t}),query:{}}},handleResponse:m()}),Je=function(){var s=M(E,function(e){return e+"/photos"});return h({getPathname:s,handleRequest:function(t){var a=t.topicIdOrSlug,r=t.orientation,n=g(t,["topicIdOrSlug","orientation"]);return{pathname:s({topicIdOrSlug:a}),query:y(u({},p(n),{orientation:r}))}},handleResponse:T()})}(),x;(function(s){s.Afrikaans="af",s.Amharic="am",s.Arabic="ar",s.Azerbaijani="az",s.Belarusian="be",s.Bulgarian="bg",s.Bengali="bn",s.Bosnian="bs",s.Catalan="ca",s.Cebuano="ceb",s.Corsican="co",s.Czech="cs",s.Welsh="cy",s.Danish="da",s.German="de",s.Greek="el",s.English="en",s.Esperanto="eo",s.Spanish="es",s.Estonian="et",s.Basque="eu",s.Persian="fa",s.Finnish="fi",s.French="fr",s.Frisian="fy",s.Irish="ga",s.ScotsGaelic="gd",s.Galician="gl",s.Gujarati="gu",s.Hausa="ha",s.Hawaiian="haw",s.Hindi="hi",s.Hmong="hmn",s.Croatian="hr",s.HaitianCreole="ht",s.Hungarian="hu",s.Armenian="hy",s.Indonesian="id",s.Igbo="ig",s.Icelandic="is",s.Italian="it",s.Hebrew="iw",s.Japanese="ja",s.Javanese="jw",s.Georgian="ka",s.Kazakh="kk",s.Khmer="km",s.Kannada="kn",s.Korean="ko",s.Kurdish="ku",s.Kyrgyz="ky",s.Latin="la",s.Luxembourgish="lb",s.Lao="lo",s.Lithuanian="lt",s.Latvian="lv",s.Malagasy="mg",s.Maori="mi",s.Macedonian="mk",s.Malayalam="ml",s.Mongolian="mn",s.Marathi="mr",s.Malay="ms",s.Maltese="mt",s.Myanmar="my",s.Nepali="ne",s.Dutch="nl",s.Norwegian="no",s.Nyanja="ny",s.Oriya="or",s.Punjabi="pa",s.Polish="pl",s.Pashto="ps",s.Portuguese="pt",s.Romanian="ro",s.Russian="ru",s.Kinyarwanda="rw",s.Sindhi="sd",s.Sinhala="si",s.Slovak="sk",s.Slovenian="sl",s.Samoan="sm",s.Shona="sn",s.Somali="so",s.Albanian="sq",s.Serbian="sr",s.Sesotho="st",s.Sundanese="su",s.Swedish="sv",s.Swahili="sw",s.Tamil="ta",s.Telugu="te",s.Tajik="tg",s.Thai="th",s.Turkmen="tk",s.Filipino="tl",s.Turkish="tr",s.Tatar="tt",s.Uighur="ug",s.Ukrainian="uk",s.Urdu="ur",s.Uzbek="uz",s.Vietnamese="vi",s.Xhosa="xh",s.Yiddish="yi",s.Yoruba="yo",s.ChineseSimplified="zh",s.ChineseTraditional="zh-TW",s.Zulu="zu"})(x||(x={}));var R;(function(s){s.LATEST="latest",s.POPULAR="popular",s.VIEWS="views",s.DOWNLOADS="downloads",s.OLDEST="oldest"})(R||(R={}));var Xe=M(He,function(s){return{photos:{get:s(xe),list:s($e),getStats:s(Re),getRandom:s(Ne),trackDownload:s(Ge)},users:{getPhotos:s(We),getCollections:s(Ke),getLikes:s(Qe),get:s(je)},search:{getCollections:s(Fe),getPhotos:s(Ve),getUsers:s(Ue)},collections:{getPhotos:s(Me),get:s(Ce),list:s(Be),getRelated:s(Oe)},topics:{list:s(ze),get:s(Ye),getPhotos:s(Je)}}});class N{constructor(e){this.MY_ACCESS_KEY="vnG4zqeBwcPQvR4H2lA56teaxU_hiGwsxuOyU_s3hDI",this.unsplashAPI=Xe({accessKey:this.MY_ACCESS_KEY}),this.tag=e}async getPhotoByTag(){return await this.unsplashAPI.search.getPhotos({query:this.tag,perPage:20,orientation:"landscape"})}}function j(s){if(s instanceof HTMLElement&&s.nodeName==="INPUT")return s.value;if(typeof s=="string"){const e=document.querySelector(`.${s.split("").includes(".")?s.split("").slice(1).join(""):s}`);return e&&e.nodeName==="INPUT"?e.value:null}}class Ze extends _{constructor(e,t,a,r,n){super(e,t,n),this._savedLang="",this._translation=r,this._locales=this.setLocales(this.lang),this._timeOfTheDay="",this._tag="",this._numberOfPictures=20,this._createImgsIndicator=0,this._currentPictureNumber=null,this._dateOptions=a.dateOptions,this._isAPISource=a.isAPISource,this._timeOfADayBorders=a.timeOfADayBorders,this.backgroundCollectionElements=[],this.isSettingsOpen=!1}startClocksBackground(){this.createImages(this._numberOfPictures),this.firstGreetBlockCreate(),this.setTimeAndDateOnPage(),this.insertDateToHTML(new Date,this.HTMLElements.date.element,this._locales,this._dateOptions),this.checkIsAPISource(),this.loadImages(this._numberOfPictures),this.setBackgroundImage()}checkIsAPISource(){const e=localStorage.getItem("isSourceAPI_bg");e===!1||e==="false"?this.setBgSource(!1):e=="true"&&this.setBgSource(!0)}setBgSource(e){this._isAPISource=e}setTimeAndDateOnPage(){const e=new Date;this.insertTimeToHTML(this.HTMLElements.time.element,e),e.toLocaleTimeString()==="00:00:00"&&this.insertDateToHTML(e,this.HTMLElements.date.element,this._locales,this._dateOptions);const t=e.getHours(),a=this.getTimeOfTheDayString(t,this._timeOfADayBorders);this._timeOfTheDay!==a&&(this._timeOfTheDay=a,this.loadImages(this._numberOfPictures),this.setBackgroundImage(),this.insertGreetToHTML(this._timeOfTheDay,this.lang,this._translation,document.querySelector(".greeting"))),setTimeout(()=>{this.setTimeAndDateOnPage()},1e3)}setTimeOfTheDay(){this._timeOfTheDay=this.getTimeOfTheDayString(new Date().getHours(),this._timeOfADayBorders)}setLocales(e){return this._translation[e].locales}set setCurrentPictureNumber(e){if(e<this._numberOfPictures||e>=0)this._currentPictureNumber=e;else throw new Error("Такого номера для фоновой картинки не существует. Установите другой номер")}createGreetsDiv(){this.HTMLElements.nameBox.element.innerHTML="";let e=this.createElement("div","name__div",this.HTMLElements.nameBox.element,[{"data-action":"name__div"}]);e.textContent=this.name}createGreetsInput(){this.HTMLElements.nameBox.element.innerHTML="",this.createElement("label",null,this.HTMLElements.nameBox.element,[{for:"name"}]),this.createElement("input","name__input",this.HTMLElements.nameBox.element,[{type:"text"},{id:"name"},{placeholder:"Enter your name"},{"data-action":"name__input"},{"data-translate":"[placeholder]customerName"},{value:`${this.name}`}])}firstGreetBlockCreate(){this.name?this.createGreetsDiv():this.createGreetsInput()}createGreetsBlock(){const e=document.querySelector('[data-action="name__input"]');this.HTMLElements.nameBox.element.innerHTML="",e?e.value!==""?(this.name=e.value,l.setItemToLocalStorage("name",this.name),this.createGreetsDiv()):this.createGreetsInput():this.createGreetsInput()}insertDateToHTML(e,t,a,r){e?t.textContent=e.toLocaleDateString(a,r):(t=document.querySelector(".date"),t.textContent=new Date().toLocaleDateString(this.setLocales(this.lang),this._dateOptions))}insertTimeToHTML(e,t){e.innerHTML=t.toLocaleTimeString()}getTimeOfTheDayString(e,t){for(const a in t)if(e>=t[a].start&&e<=t[a].end)return a==="night1"||a==="night2"?"night":a}insertGreetToHTML(e,t,a,r){let n;switch(e){case"morning":n="morning";break;case"afternoon":n="afternoon";break;case"evening":n="evening";break;case"night":n="night";break}r.innerHTML=`${a[t][n]} `,r.dataset.translate=n}createImages(e){for(let t=0;t<e;t++){const a=new Image;a.dataset.backgroundId=t,a.alt="background image",a.classList.add("carousel__item"),this.backgroundCollectionElements.push(a),this._createImgsIndicator=1}}loadImages(){if(this.HTMLElements.carousel.element.innerHTML="",this._isAPISource){let e;this._tag?e=new N(`${this._tag}`):e=new N(`${this._timeOfTheDay}, nature`),e.getPhotoByTag().then(t=>{t.status===200?this.backgroundCollectionElements.forEach((a,r)=>{a.src=`${t.response.results[r].urls.raw}&fit=crop&w=${window.innerWidth}&h=${window.innerHeight}`,a.classList.add("API-image"),this.HTMLElements.carousel.element.append(a)}):(this.setBgSource(!1),this.loadImages(this._numberOfPictures))})}else for(let e=0;e<this._numberOfPictures;e++)this.backgroundCollectionElements[e].src=`${this.composeBGPicturePath(this._timeOfTheDay,e+1<=9?`0${e+1}`:(e+1).toString())}`,[...this.backgroundCollectionElements[e].classList].includes("API-image")&&this.backgroundCollectionElements[e].classList.remove("API-image"),this.HTMLElements.carousel.element.append(this.backgroundCollectionElements[e])}composeBGPicturePath(e,t){return`https://raw.githubusercontent.com/iamarrow88/bg-collection/main/${e}/${t}.webp`}getNextPictureNumber(e,t,a){let r;if(e==="next"){if(r=+t+1,r>=a)return 0}else if(r=+t-1,r<1)return+(a-1);return+r}setBackgroundImage(e){e||e!==0&&(e=this.getRandomNumber(this._numberOfPictures)),this._currentPictureNumber=e,this.backgroundCollectionElements.forEach(t=>t.classList.remove("visible")),this.backgroundCollectionElements[e]||(e=0),this.backgroundCollectionElements[e].classList.add("visible")}changeBackground(e){switch(e.target.dataset.action){case"slide-next":case"slide-prev":{const a="next",r=this.getNextPictureNumber(a,this._currentPictureNumber,this._numberOfPictures);this.setBackgroundImage(r);break}case"settings-icon":{this.isSettingsOpen?this.HTMLElements.settingsBlock.element.classList.remove("visible"):this.HTMLElements.settingsBlock.element.classList.add("visible"),document.querySelector("#edit-block").classList.remove("visible"),this.isSettingsOpen=!this.isSettingsOpen;break}case"settings-edit-data-btn":{document.querySelector("#edit-block").classList.toggle("visible");break}default:{this.HTMLElements.settingsBlock.element.classList.remove("visible"),document.querySelector("#edit-block").classList.remove("visible"),this.isSettingsOpen=!1;break}}}setCustomerName(e){return e!==""?this.name=e:console.log("Имя не может быть пустым. Пробуйте ввести его еще раз"),this.name}nameHandler(e){if(e.target.dataset.action==="name__div")this.createGreetsBlock();else if(e.target.dataset.action!=="name__input"&&document.querySelector(".name__input")||e.target.dataset.action==="name__input"&&e.type==="change"){const t=j(document.querySelector(".name__input"));this.setCustomerName(t),l.setItemToLocalStorage("name",this.name),this.createGreetsBlock()}}blockLayoutsAction(e){const t=[".player",".weather",".time",".date",".greeting-container",".motivation-block",".quote"];e==="on"?t.forEach(a=>{document.querySelector(a).classList.add("dark-layout")}):e==="off"?t.forEach(a=>{document.querySelector(a).classList.remove("dark-layout")}):console.log("не выбрано действие с подложками блоков. Проверьте")}}class et extends _{constructor(e,t,a){super(e),this._url=t.url,this._APIkey=t.APIKey,this.basicQuotesArray=t.quotesArray,this.quotesArray=[],this.source=t.source,this.HTMLElements=a,this.quotesCounter=0}startQuotes(){this.quotesHandler()}checkSource(){return this.source!=="API"&&this.setQuotesSource("project"),this.source}setQuotesSource(e){return e==="API"||e==="project"?this.source=e:this.source="project",l.setItemToLocalStorage("isSourceAPI_q",this.source),this.source}isSourceAPI(){return this.checkSource(),this.source==="API"}async getActualQuotesArray(){if(this.isSourceAPI()){const e=await this.getData(this._url);e.isOk?this.quotesArray=e.json:(console.log("извините, цитаты не были получены с API. Источником цитат установлен проект"),this.setQuotesSource("project"),this.quotesArray=await this.basicQuotesArray)}else this.quotesArray=await this.basicQuotesArray;return this.quotesArray}animationStart(){document.querySelector("div.change-btn").classList.add("refresh"),this.getActualQuotesArray().then(e=>{setTimeout(()=>{document.querySelector("div.change-btn").classList.remove("refresh")},1e3)})}setQuotesCounterValue(e){return e>=this.quotesArray.length?this.quotesCounter=0:e<0?this.quotesCounter=this.quotesArray.length-1:this.quotesCounter=e,this.quotesCounter}printQuote(){(!this.HTMLElements.quote.element||!this.HTMLElements.quoteAuthor.element)&&(this.HTMLElements.quote.element=document.querySelector(".quote__quote"),this.HTMLElements.quoteAuthor.element=document.querySelector(".quote__author")),this.HTMLElements.quote.element.innerHTML=this.quotesArray[this.quotesCounter].text||this.quotesArray[this.quotesCounter].quote,this.HTMLElements.quoteAuthor.element.innerHTML=this.quotesArray[this.quotesCounter].author||this.quotesArray[this.quotesCounter].source,this.setQuotesCounterValue(this.quotesCounter+1)}quotesHandler(){this.getActualQuotesArray().then(e=>this.printQuote()),this.animationStart()}}class tt extends _{constructor(e,t,a,r){super(e),this.city=t,this.savedCity="",this.HTMLElements=a,this._APIKey=r.APIKey,this._url="",this._urlToIcon=r.urlToIcon,this._responseSchema=r.responseSchema,this._iconTemplate="",this._blocksToHide=r.blocksToHide,this._lastUpdateTime=new Date().getTime()}startWeather(){this.setUrl(),this.drawCityName(this.HTMLElements.cityNameDiv.element),this.getWeather()}setUrl(){return this._url=`https://api.openweathermap.org/data/2.5/weather?q=${this.city}&APPID=${this._APIKey}&lang=${this.lang}&units=metric`,this._url}drawCityName(e){e.innerHTML=this.city}createWeatherInput(){this.HTMLElements.cityNameBlock.element.innerHTML="",this.createElement("label",null,this.HTMLElements.cityNameBlock.element,[{for:"city-name"}]),this.createElement("input","city-name__input",this.HTMLElements.cityNameBlock.element,[{type:"text"},{id:"city-name"},{placeholder:"Enter your city"},{"data-action":"city-name-input"},{"data-translate":"[placeholder]weather-city-input"},{value:`${this.city}`}])}createWeatherDiv(){this.HTMLElements.cityNameBlock.element.innerHTML="";const e=this.createElement("div","city-name__div",this.HTMLElements.cityNameBlock.element,[{"data-action":"city-name-div"}]);this.drawCityName(e),this.shouldRefreshWeather()&&this.refreshWeatherData()}shouldRefreshWeather(){if(this.savedCity!==this.city)return l.setItemToLocalStorage("city",this.city),!0}weatherHandling(e){if(e.target.dataset.action==="city-name-div")this.createWeatherInput();else if(e.target.dataset.action!=="city-name-input"&&document.querySelector(".city-name__input")||e.target.dataset.action==="city-name-input"&&e.type==="change"){const t=document.querySelector(".city-name__input").value;this.setCityName(t),this.createWeatherDiv()}}setCityName(e){return this.savedCity=this.city,e===""?document.querySelector(".weather__error-block").innerHTML='<div class="weather-error__text">There is no city name. Try again.</div><div class="weather-error__text">Название города не введено. Попробуйте еще раз</div>':this.city=e,this.city}getWeather(){this.getData(this._url).then(e=>{if(e.isOk){this.HTMLElements.errorBlock.element.innerHTML="",this._blocksToHide.forEach(t=>{[...this.HTMLElements[t].element.classList].includes("invisible")&&this.HTMLElements[t].element.classList.remove("invisible")});for(const t in this._responseSchema){const a=document.querySelector(`${this.HTMLElements[t].selector}`);t==="iconPath"?(this._iconTemplate=`${this._urlToIcon+e.json[this._responseSchema[t][0]][this._responseSchema[t][1]][this._responseSchema[t][2]]}.png`,a.src=this._iconTemplate,a.alt=e.json.weather[0].description):t==="temperature"||t==="windSpeed"||t==="humidity"?a.innerHTML=Math.round(e.json[this._responseSchema[t][0]][this._responseSchema[t][1]]):a.textContent=e.json[this._responseSchema[t][0]][this._responseSchema[t][1]][this._responseSchema[t][2]]}this._lastUpdateTime=new Date().getTime()}else this.HTMLElements.errorBlock.element.innerHTML='<div class="weather-error__text">Error! this city was not found. Try another.</div><div class="weather-error__text">Ошибка! Город не найден. Попробуйте другой город</div>',this._blocksToHide.forEach(t=>this.HTMLElements[t].element.classList.add("invisible"))})}checkLastUpdate(e=10,t=1){const r=6e4*e*.99;new Date().getTime()-this._lastUpdateTime>=r&&(this.getWeather(),this._lastUpdateTime=new Date().getTime()),setTimeout(()=>{this.checkLastUpdate(e,t)},t*6e4)}refreshWeatherData(){this.setUrl(),this.getWeather()}}class st extends _{constructor(e,t,a){super(e),this.initTasks=t,this.tasksArray=[],this.idCounter=new Date().getTime(),this.HTMLElements=a,this._isDoneTasksHide=!1,this._isFakeTasksDestroyed=!1,this._filterType="desc"}startToDo(){this.checkIsDoneTasksHide(),this.areAnyTasksInLocalStorage()?this.getTasksFromLocalStorage():this.tasksArray=this.initTasks,this.tasksArray=this.sortTasksByDone(this.tasksArray),this.drawTasksList(),this._isDoneTasksHide&&this.hideDoneTasks()}drawTasksList(){console.log("draw"),document.querySelector(".to-do__task-list").innerHTML="",this.tasksArray.forEach(e=>{this.drawTaskLine(e)})}createNewTaskData(e){if(e){const t={taskValue:e,done:!1,id:this.idCounter};return this.idCounter+=1,t}return!1}addTaskToArray(e){return e?(this.tasksArray.push(e),this.tasksArray):!1}drawTaskLine(e){if(e){const t=this.createElement("div",["task__item","item"],this.HTMLElements.tasksList.element,[{"data-task":`${e.id}`}]),a=this.createElement("div","item__wrapper",t,null),r=this.createElement("div","item__actions",t,null),n=this.createElement("input","to-do__task",a,[{id:`task${e.id}`},{type:"checkbox"}]),i=this.createElement("label","to-do__task-label",a,[{for:`task${e.id}`},{"data-task":`${e.id}`}]);if(e.done==="true"||e.done===!0)n.checked=!0,i.classList.add("crossed-out"),this._isDoneTasksHide&&a.classList.add("invisible");else{const o=this.createElement("span","item__edit",r,[{"data-action":"task-edit"}]),c=this.createElement("span","item__delete",r,[{"data-action":"task-delete"}]),k=this.createElement("span","item__submit",r,[{"data-action":"task-submit"}]);o.innerHTML="&#128393;",c.innerHTML="&#128465;",k.innerHTML="&#10003;"}return i.innerHTML=`${e.taskValue}`,!0}else return!1}cleanInput(){document.querySelector(".to-do__input").value=""}isCheckboxChecked(e){return e.checked}sortTasksByDone(e){let t=[],a=[];e.forEach(i=>{i.done==="true"||i.done===!0?t.push(i):a.push(i)});const r=this.sortTasksByID(a,this._filterType),n=this.sortTasksByID(t,this._filterType);return r.concat(n)}sortTasksByID(e,t="desc"){const a=e.map(i=>i.id),r=t==="desc"?function(i,o){return i-o}:function(i,o){return o-i};a.sort(r),console.log(a);let n=[];return a.forEach(i=>{for(let o=0;o<Object.keys(this.tasksArray).length;o++)if(+this.tasksArray[o].id==+i){n.push(this.tasksArray[o]);break}}),console.log(n),n}addDoneStyle(e){let t;return this.isCheckboxChecked(e)?(e.nextElementSibling.classList.add("crossed-out"),t=!0):(e.nextElementSibling.classList.remove("crossed-out"),t=!1),t}setDoneTaskData(e){this.tasksArray.forEach(t=>{+t.id==+e.nextElementSibling.dataset.task&&(t.done=e.checked)})}hideDoneTasks(){document.querySelectorAll(".item__wrapper").forEach(t=>{t.firstChild.checked&&t.classList.toggle("invisible")})}destroyFakeTasks(){const e=[0,1,2];let t=[];return this.tasksArray.forEach(a=>{e.includes(a.id)||t.push(a)}),t}toDoHandler(e){if(console.log(e.type),console.log(e.target),[...e.target.classList].includes("to-do__input")&&e.type==="change"){const t=this.createNewTaskData(j(e.target));t&&(this.addTaskToArray(t),this._isFakeTasksDestroyed||(this.tasksArray=this.destroyFakeTasks(),this.drawTasksList()),l.setObjectFieldsToLocalStorage(t,"task"),this.tasksArray=this.sortTasksByID(this.tasksArray),this.tasksArray=this.sortTasksByDone(this.tasksArray),this.drawTasksList(),this.cleanInput())}else if([...e.target.classList].includes("to-do__btn"))this._isDoneTasksHide=!this._isDoneTasksHide,l.setItemToLocalStorage("isDoneTasksHide",`${this._isDoneTasksHide}`),this.hideDoneTasks();else if([...e.target.classList].includes("to-do__task"))this.addDoneStyle(e.target),this._isDoneTasksHide&&this.hideDoneTasks(),this.setDoneTaskData(e.target),l.setItemToLocalStorage(`task-${e.target.closest(".item").dataset.task}-done`,e.target.checked),this.tasksArray=this.sortTasksByDone(this.tasksArray),this.drawTasksList();else if(e.target.dataset.action==="task-edit"){console.log("task-edit");const t=e.target.closest(".item").dataset.task,r=document.querySelector(".to-do__task-list").querySelectorAll('input[type="text"]');r.length!==0&&r.forEach(c=>{const k=c.value,b=c.dataset.task;document.querySelector(`div[data-task="${b}"]`).classList.remove("editing"),this.changeDivToInput(b,k)});const n=document.querySelector(`.item[data-task="${t}"] .item__submit`);n.style.display="block",e.target.closest(".item").classList.add("editing");const i=document.querySelector(`label[data-task="${t}"]`).innerHTML,o=document.querySelector(".editing .item__wrapper");o.innerHTML="",this.createElement("input","item__input",o,[{type:"text"},{name:"task-value"},{id:"task-value"},{value:`${i}`},{"data-task":`${t}`}]),document.querySelector(".to-do__input").style.pointerEvents="none"}else if(e.target.dataset.action==="task-delete"){console.log("task-delete");const t=+e.target.closest(".item").dataset.task;let a;this.tasksArray.forEach((r,n)=>{+r.id===t&&(a=n)}),l.deleteObjectFieldsFromLocalStorage(this.tasksArray[a],"task"),this.tasksArray=this.tasksArray.slice(0,a).concat(this.tasksArray.slice(a+1)),this.tasksArray=this.sortTasksByID(this.tasksArray),this.tasksArray=this.sortTasksByDone(this.tasksArray),this.drawTasksList()}if(e.target.dataset.action==="task-submit"||e.type==="change"&&[...e.target.classList].includes("item__input")){console.log("task-submit");const t=e.target.closest(".item").dataset.task,a=document.querySelector("#task-value").value;l.setItemToLocalStorage(`task-${t}-taskValue`,a),this.changeDivToInput(t,a),document.querySelector(".to-do__input").style.pointerEvents="auto";const r=document.querySelector(`.item[data-task="${t}"] .item__submit`);r.style.display="none",document.querySelector(`div[data-task="${t}"]`).classList.remove("editing")}else e.target.dataset.action==="filter"&&(this._filterType=this._filterType==="desc"?"asc":"desc",this.tasksArray=this.sortTasksByDone(this.tasksArray),this.drawTasksList())}changeDivToInput(e,t){const a=document.querySelector(`div[data-task="${e}"] .item__wrapper`);a.innerHTML="",this.createElement("input","to-do__task",a,[{id:`task${e}`},{type:"checkbox"}]);const r=this.createElement("label","to-do__task-label",a,[{for:`task${e}`},{"data-task":`${e}`}]);r.innerHTML=`${t}`}changeInputToDiv(e,t){const a=document.querySelector(`div[data-task="${e}"] .item__wrapper`);a.innerHTML="",this.createElement("input","to-do__task",a,[{id:`task${e}`},{type:"checkbox"}]);const r=this.createElement("label","to-do__task-label",a,[{for:`task${e}`},{"data-task":`${e}`}]);r.innerHTML=`${t}`}areAnyTasksInLocalStorage(){let e=!1;return Object.keys(localStorage).forEach(t=>{t.split("-").includes("task")&&(e=!0)}),e}getTasksFromLocalStorage(){let e={};return Object.keys(localStorage).forEach(t=>{const a=t.split("-");if(a.includes("task")){const r=+a[1],n=a[2];e[r]||(e[r]={id:r,taskValue:"",done:!1}),n==="taskValue"?e[r].taskValue=localStorage.getItem(`${t}`):n==="done"&&(e[r].done=localStorage.getItem(`${t}`))}}),this.tasksArray=[],Object.keys(e).forEach(t=>{this.tasksArray.push(e[t])}),this.tasksArray}checkIsDoneTasksHide(){const e=l.getItemFromLocalStorage("isDoneTasksHide");this._isDoneTasksHide=!(e==="false"||!e)}unHideTasks(){}}function at(s,e){s.key==="Enter"&&s.target.dataset.action==="city-name-input"||s.type==="change"&&s.target.dataset.action==="city-name-input"?e.weather.weatherHandling(s):s.key==="Enter"&&[...s.target.classList].includes("name__input")||s.type==="change"&&[...s.target.classList].includes("name__input")?e.name.nameHandler(s):(s.type==="change"&&[...s.target.classList].includes("to-do__input")||s.type==="change"&&[...s.target.classList].includes("item__input"))&&e.todo.toDoHandler(s)}const G={classToRemove:"",newClass:"",changeStyle(s){const e=document.querySelector(`${s}`);if(!e)throw new Error(`Элемент с классом ${s} не найден. Проверьте переданный селектор`);[...e.classList].includes(this.classToRemove)&&e.classList.remove(this.classToRemove),e.classList.add(this.newClass)}},I={datasetChange(s,e,t){document.querySelector(`[data-${s}="${e}"]`).dataset[s]=`${t}`},blockInnerToggle(s,e,t){s.innerHTML=w[e][t]}};function rt(s,e){if(s.target.closest(".player"))e.player.playerClicksHandler(s,e.player);else if(s.target.closest(".city-name-block"))console.log("weather"),e.weather.weatherHandling(s);else if([...s.target.classList].includes("name__div")||[...s.target.classList].includes("name__input"))e.background.nameHandler(s);else if(s.target.dataset.action==="slide-next"||s.target.dataset.action==="slide-prev"||s.target.closest(".settings-block")||s.target.dataset.action==="settings-icon")console.log("slider or settings clicks"),e.background.changeBackground(s),e.settings.settingsClicks(s,e);else if(s.target.closest(".to-do"))e.todo.toDoHandler(s);else if([...s.target.classList].includes("change-btn"))e.quotes.quotesHandler(s);else{console.log("another element"),e.background.nameHandler(s),e.background.changeBackground(s),e.weather.weatherHandling(s);const t=document.querySelector('.item__wrapper input[type="text"]');console.log(t);const a=Object.keys(s.target.dataset);if(console.log(a),t){console.log(t.closest(".item")),t.closest(".item").classList.remove("editing");const n=t.value,i=t.dataset.task;console.log(n,i),e.todo.changeDivToInput(i,n);const o=document.querySelector(`.item[data-task="${i}"] .item__submit`);o.style.display="none"}!s.target.dataset.action==="settings-icon"&&document.querySelector(".footer__settings").classList.remove("visible");let r=[];[...s.target.classList].includes("hide-block__btn")&&(I.datasetChange("translate",r[0],r[1]),I.blockInnerToggle(s.target,e.settings.lang,r[1]))}}function nt(s,e){if(e==="translate"){const t=s.dataset.translate,a=t.split("-")[t.split("-").length-1]==="off"?"on":"off";let r=t.split("-").slice(0,t.split("-").length-1).concat([a]).join("-");return[t,r]}}class it{constructor(e,t,a){this.lang=e,this.langs=t,this.savedLang=this.langs.findIndex(r=>r===this.lang)===0?this.langs[1]:this.langs[0],this.translateMap=a,this.blocksToTranslate=[]}startSettings(){this.setUp(),this.translatePage(this.lang)}setUp(){this.blocksToTranslate=document.querySelectorAll("[data-translate]")}translatePage(e,t){if(this.savedLang!==e){this.savedLang=e;for(let a=0;a<this.blocksToTranslate.length;a++)if(this.blocksToTranslate[a].dataset.translate==="date")t&&t.insertDateToHTML();else{const r=this.blocksToTranslate[a].dataset.translate;this.blocksToTranslate[a].innerHTML=this.translateMap[e][r]}}}toggleSettingsDataset(e,t){const a=nt(e,"translate");I.datasetChange("translate",t,a[1]),I.datasetChange("action",t,a[1]),I.blockInnerToggle(e,this.lang,a[1])}settingsClicks(e,t){const a=G.changeStyle.bind({classToRemove:"invisible-block",newClass:"visible-block"}),r=G.changeStyle.bind({classToRemove:"visible-block",newClass:"invisible-block"}),n=e.target.dataset.action;switch(n){case"settings-change-lang-ru":console.log("сменить язык на русский"),this.lang="ru",console.log(t.background),this.translatePage(l.setItemToLocalStorage("lang","ru"),t.background),Object.keys(t).forEach(i=>t[i].lang=this.lang),t.weather.refreshWeatherData(),t.background.insertDateToHTML();break;case"settings-change-lang-en":console.log("сменить язык на английский"),this.lang="en",console.log(t.background),this.translatePage(l.setItemToLocalStorage("lang","en"),t.background),Object.keys(t).forEach(i=>t[i].lang=this.lang),t.weather.refreshWeatherData(),t.background.insertDateToHTML();break;case"settings-edit-data-btn":console.log("редактировать данные пользователя и добавить их в локал сторадж");break;case"settings-name":console.log("редактировать данные пользователя и добавить их в локал сторадж");break;case"settings-city":console.log("редактировать данные пользователя и добавить их в локал сторадж");break;case"settings-remove-data-btn":console.log("удалить все данные пользователя из локал сторадж"),l.clearLocalStorage();break;case"settings-background-api":console.log("выбрать источником обоев API"),t.background._isAPISource=!0,l.setItemToLocalStorage("isSourceAPI_bg",!0),t.background.loadImages(t.background._numberOfPictures),t.background.setBackgroundImage();break;case"settings-background-github":console.log("выбрать источником обоев github"),t.background._isAPISource=!1,l.setItemToLocalStorage("isSourceAPI_bg",!1),t.background.loadImages(t.background._numberOfPictures),t.background.setBackgroundImage();break;case"settings-quotes-api":console.log("выбрать источником цитат API"),t.quotes.setQuotesSource("API"),t.quotes.quotesHandler();break;case"settings-quotes-github":console.log("выбрать источником цитат проект"),t.quotes.setQuotesSource("project"),t.quotes.quotesHandler();break;case"hide-player-on":{console.log("спрятать плейер"),r(".player"),this.toggleSettingsDataset(e.target,n),l.setItemToLocalStorage("isPlayerVisible",!1);break}case"hide-player-off":{console.log("показать плейер"),a(".player"),this.toggleSettingsDataset(e.target,n);break}case"hide-weather-on":console.log("спрятать погоду"),r(".weather"),this.toggleSettingsDataset(e.target,n),l.setItemToLocalStorage("isWeatherVisible",!1);break;case"hide-weather-off":console.log("показать блок с погодой"),a(".weather"),this.toggleSettingsDataset(e.target,n),l.setItemToLocalStorage("isWeatherVisible",!0);break;case"hide-clocks-on":console.log("спрятать блок с часами"),r(".time"),this.toggleSettingsDataset(e.target,n),l.setItemToLocalStorage("isClocksVisible",!1);break;case"hide-clocks-off":console.log("показать блок с часами"),a(".time"),this.toggleSettingsDataset(e.target,n);break;case"hide-date-on":console.log("спрятать блок с датой"),r(".date"),this.toggleSettingsDataset(e.target,n),l.setItemToLocalStorage("isDateVisible",!1);break;case"hide-date-off":console.log("показать блок с датой"),a(".date"),this.toggleSettingsDataset(e.target,n);break;case"hide-greetings-on":console.log("спрятать блок с приветствием"),l.setItemToLocalStorage("isGreetingsVisible",!1),r(".greeting-container"),this.toggleSettingsDataset(e.target,n);break;case"hide-greetings-off":console.log("показать блок с приветствием"),a(".greeting-container"),this.toggleSettingsDataset(e.target,n),l.setItemToLocalStorage("isGreetingsVisible",!1);break;case"hide-todo-on":console.log("спрятать блок со списком дел"),r(".motivation-block"),this.toggleSettingsDataset(e.target,n),l.setItemToLocalStorage("isToDoVisible",!1);break;case"hide-todo-off":console.log("показать блок со списком дел"),a(".motivation-block"),this.toggleSettingsDataset(e.target,n),l.setItemToLocalStorage("isToDoVisible",!0);break;case"hide-quotes-on":console.log("спрятать блок с цитатами"),r(".quote"),this.toggleSettingsDataset(e.target,n),l.setItemToLocalStorage("isQuotesVisible",!1);break;case"hide-quotes-off":console.log("показать блок с цитатами"),a(".quote"),this.toggleSettingsDataset(e.target,n),l.setItemToLocalStorage("isQuotesVisible",!0);break;case"hide-layouts-on":console.log("показать подложки под блоки"),t.background.blockLayoutsAction("on"),this.toggleSettingsDataset(e.target,n),l.setItemToLocalStorage("isLayoutsVisible",!0);break;case"hide-layouts-off":console.log("скрыть подложки под блоками"),t.background.blockLayoutsAction("off"),this.toggleSettingsDataset(e.target,n),l.setItemToLocalStorage("isLayoutsVisible",!1);break}}}class ot extends _{constructor(e,t,a,r,n){super(e,t,n,a),this.date=new Date,this.appStore=r,this.player=new le(e,t,a,r.HTMLElements,r.player),this.background=new Ze(e,t,r.clocks,r.translation,r.HTMLElements),this.langs=Object.keys(r.translation),this.quotes=new et(e,r.quotes,n),this.weather=new tt(e,a,n,this.appStore.weather),this.toDo=new st(e,r.toDo.tasksArray,n),this.settings=new it(e,this.langs,r.translation)}set setLang(e){Object.keys(this.appStore.translation).includes(e)?this.lang=e:(console.log(`Ошибка - введенный язык не найден. Выбран английский язык.
Attention! The selected language is not found. English was set.`),this.lang="en"),l.setItemToLocalStorage("lang",this.lang)}set setName(e){this.name=e}set setCity(e){this.city=e}setProperty(e,t){this[e]=t}startApp(){this.searchHTMLElements.apply(this.appStore),this.player.startPlayer(),this.background.startClocksBackground(),this.weather.startWeather(),this.weather.checkLastUpdate(5,1),this.quotes.startQuotes(),this.toDo.startToDo(),this.settings.startSettings(),document.querySelectorAll("div.slider-icon").forEach(a=>a.style.height=`${window.innerHeight}`);const e={player:this.player,background:this.background,weather:this.weather,todo:this.toDo,quotes:this.quotes,settings:this.settings,app:this};this.HTMLElements.background.element.addEventListener("click",a=>{rt(a,e)}),this.HTMLElements.background.element.addEventListener("input",a=>{this.player.changeHandler(a)});const t={weather:this.weather,name:this.background,todo:this.toDo};this.HTMLElements.background.element.addEventListener("change",a=>{at(a,t)})}}const lt=localStorage.getItem("lang")||"en",ct=localStorage.getItem("name")||"",ht=localStorage.getItem("city")||"Minsk",ut=new ot(lt,ct,ht,O,O.HTMLElements);ut.startApp();
